-- Tabla puesto
CREATE TABLE public.puesto
(
    id     BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    puesto VARCHAR(255) NOT NULL UNIQUE,
    CONSTRAINT puesto_puesto_check CHECK (puesto IN ('ADMINISTRADOR', 'COCINERO', 'CAMARERO', 'PINCHE'))
);

-- Tabla turno
CREATE TABLE public.turno
(
    id    BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    turno VARCHAR(255) NOT NULL UNIQUE,
    CONSTRAINT turno_turno_check CHECK (turno IN ('MANANA', 'MEDIO', 'TARDE'))
);

-- Tabla usuario
CREATE TABLE public.usuario
(
    id                  BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username            VARCHAR(20)  NOT NULL UNIQUE,
    password            VARCHAR(255) NOT NULL,
    activo              BOOLEAN,
    nombre              VARCHAR(100),
    fecha_creacion      TIMESTAMP(6),
    fecha_actualizacion TIMESTAMP(6)
);

-- Tabla usuario_roles
CREATE TABLE public.usuario_roles
(
    usuario_id BIGINT NOT NULL,
    puesto     VARCHAR(255) NOT NULL,
    CONSTRAINT usuario_roles_puesto_check CHECK (puesto IN ('ADMINISTRADOR', 'COCINERO', 'CAMARERO', 'PINCHE')),
    CONSTRAINT fk_usuario_roles_usuario FOREIGN KEY (usuario_id) REFERENCES public.usuario (id)
);

-- Tabla tarea
CREATE TABLE public.tarea
(
    id               BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    completada       BOOLEAN       NOT NULL DEFAULT false,
    descripcion      VARCHAR(3000) NOT NULL,
    dia_mes          INTEGER,
    dia_semana       VARCHAR(255),
    fecha            DATE,
    fecha_completada TIMESTAMP(6) WITH TIME ZONE,
    tipo_recurrencia VARCHAR(255) NOT NULL ,
    puesto_id        BIGINT,
    turno_id         BIGINT,
    CONSTRAINT tarea_dia_semana_check CHECK (dia_semana IN
                                             ('LUNES', 'MARTES', 'MIERCOLES', 'JUEVES', 'VIERNES', 'SABADO',
                                              'DOMINGO')),
    CONSTRAINT tarea_tipo_recurrencia_check CHECK (tipo_recurrencia IN
                                                   ('DIARIA', 'SEMANAL', 'QUINCENAL', 'MENSUAL', 'UNA_VEZ')),
    CONSTRAINT fk_tarea_puesto FOREIGN KEY (puesto_id) REFERENCES public.puesto (id),
    CONSTRAINT fk_tarea_turno FOREIGN KEY (turno_id) REFERENCES public.turno (id)
);
